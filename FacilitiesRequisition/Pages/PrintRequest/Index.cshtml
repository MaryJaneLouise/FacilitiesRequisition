@page
@using FacilitiesRequisition.Models.FacilityRequests
@model FacilitiesRequisition.Pages.PrintRequest.IndexModel

@{
    
}

<html>
<head>
    <title></title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
</head>
<body>
<div id="previewSection">
    <div style="display:flex;align-items:stretch;justify-content:center;">
        <img src="~/images/AUF_Logo.png" style="width:8%; height:8%"/>
        <div class="text-center" style="margin-top:20px;margin-left:20px">
            <h4>Angeles University Foundation</h4>
            <h6>Facility Request form</h6>
        </div>
    </div>
    
    <div class="container-fluid">
        <div style="margin: 0 0 0 0">
            <p>Date Filed: @Model.FacilityRequest.DateFiled</p>
            <p>Name of the Requester: @Model.FacilityRequest.Requester.Name</p>
            <p>Venue Requested: @Model.FacilityRequest.VenueRequested</p>
            <p>Date Requested: @Model.FacilityRequest.StartDateRequested.Value.ToShortDateString() to @Model.FacilityRequest.EndDateRequested.Value.ToShortDateString()</p>
            <p>Additional Comments from Requester: @Model.FacilityRequest.AdditionalComments</p>
            <p>Estimated Budget total: @Model.FacilityRequest.Requester.TotalBudget</p>
            
            
            <p>Requested by: @Model.Signatories.President.User.FullName</p>
            <p>Endorsed by: @Model.Signatories.Dean.User.FullName</p>
            <p>Request cleared by: @Model.Signatories.AdminServicesDirector.User.FullName</p>
            <p>Activity cleared by: @Model.Signatories.StudentAffairsDirector.User.FullName</p>
            <p>Request for Admin Support cleared by: @Model.Signatories.CampusFacilitiesDevelopmentDirector.User.FullName</p>
            <p>Accounting Support cleared by: @Model.Signatories.AccountingOfficeDirector.User.FullName</p>
            <p>Approved by:</p>
            <p>@Model.Signatories.VicePresidentAdministration.User.FullName</p>
            <p>@Model.Signatories.VicePresidentAcademicAffairs.User.FullName</p>
        </div>
    </div>
</div>

<div id="buttons">
    <button type="button" onclick="printPreview()">Print</button>
    <button type="button" id="exportButton" onclick="exportToPDF()">Export as PDF</button>
</div>

<script>
        function exportToPDF() {
            const previewSection = document.getElementById('previewSection');
            
            // Options for PDF generation
            const options = {
                filename: 'document.pdf',
                jsPDF: { format: 'letter' }
            };
            
            // Generate the PDF
            html2pdf().set(options).from(previewSection).save();
        }
        
        function printPreview() {
            // Hide the button section
                        const buttonSection = document.getElementById('buttons');
                        buttonSection.style.display = 'none';
                        
                        // Open print dialog for the preview section
                        window.print();
                        
                        // Show the button section again after printing is done
                        buttonSection.style.display = 'block';
        }
    </script>

</body>
</html>