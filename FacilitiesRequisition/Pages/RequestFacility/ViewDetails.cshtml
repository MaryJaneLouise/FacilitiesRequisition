@page
@using FacilitiesRequisition.Models.FacilityRequests
@using FacilitiesRequisition.Pages.Organizations
@model FacilitiesRequisition.Pages.RequestFacility.DetailsModel

@{
    ViewData["Title"] = "Details";
}

<html>
<head>
    <title></title>
    <link rel="stylesheet" href="./css/site.css">
</head>
<body style="background: #EEEEEE">
    <div>
        <div class="row d-flex justify-content-md-center align-items-center vh-100">
            <div class="col-md-7">
                <div class="rounded-rectangle" style="margin-right: 10px; height: 750px">
                    <h2>View @Model.FacilityRequest.NameActivity details</h2>
                    
                    <div style="float: right; margin-bottom: 20px">
                        <a class="btn btn-outline-primary" asp-page="./Index">Go back</a>
                        <a class="btn btn-primary" asp-page="./EditDetails" asp-route-id="@Model.FacilityRequest?.Id">Edit details</a>
                    </div>
                    
                    <div>
                        <br/>
                        <label>Date Filed</label>
                        <input asp-for="FacilityRequest.DateFiled" class="form-control" disabled/>
                    </div>
                
                    <div>
                        <br/>
                        <label>Requester</label>
                        <input asp-for="FacilityRequest.Requester.Name" class="form-control" disabled/>
                    </div>
                
                    <div>
                        <br/>
                        <label>Name of Activity</label>
                        <input asp-for="FacilityRequest.NameActivity" class="form-control" disabled/>
                    </div>
                
                    <div>
                        <br/>
                        <label>Contact Number</label>
                        <input asp-for="FacilityRequest.ContactNumber" class="form-control" disabled/>
                    </div>
                
                    <div>
                        <br/>
                        <label>Venue Requested</label>
                        <input asp-for="FacilityRequest.VenueRequested" class="form-control" disabled/>
                    </div>
                
                    <div>
                        <br/>
                        <label>Start Date</label>
                        <input asp-for="FacilityRequest.StartDateRequested" class="form-control" disabled/>
                    </div>
                
                    <div>
                        <br/>
                        <label>End Date</label>
                        <input asp-for="FacilityRequest.EndDateRequested" class="form-control" disabled/>
                        <br/>
                    </div>
                </div>
            </div>
            
            <div class="col-md-5">
                <div class="rounded-rectangle" style="margin-left: 10px; height: 750px">
                    <h2>Signatories</h2>
                    
                    <div>
                        @foreach (var signatory in Model.Signatories.ToList()) {
                            <div class="hover-item">
                                <div style="display: flex; align-items: center">
                                    <div class="profile-icon" style="margin-right: 10px; margin-left: 10px">
                                        <span>@signatory.User.FirstName.Substring(0, 1)</span>
                                    </div>
                                    
                                    <div style="font-size: medium; horiz-align: center">
                                        @signatory.User.FullName
                                        <div style="font-size: small">
                                            @if (signatory is AdministratorSignatory administratorSignatory) {
                                                @Html.DisplayFor(model => administratorSignatory.Role.Position)
                                            }
                                            @if (signatory is OfficerSignatory officerSignatory) {
                                                @Html.DisplayFor(model => officerSignatory.Role.Position)
                                            }
                                        </div>
                                    </div>
                                    
                                    <div style="margin-left: auto; margin-right: 10px; justify-content: end">
                                        <form method="post">
                                            @if (signatory.User == Model.User) {
                                                if (!signatory.IsSigned) {
                                                    <input type="submit" value="Signed" class="btn btn-secondary mb-2" asp-page-handler="Approve" asp-route-id="@Model.FacilityRequest.Id"/>
                                                }
                                                else {
                                                    <input type="submit" value="Unsign" class="btn btn-secondary mb-2" asp-page-handler="Disapprove" asp-route-id="@Model.FacilityRequest.Id"/>
                                                }
                                            } else {
                                                if (!signatory.IsSigned) {
                                                    @: <text>Unsigned</text>
                                                } else {
                                                    @: <text>Signed</text>
                                                }
                                            }
                                        </form>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>    
    </div>
</body>
</html>